# Релизная_политика

## Релизная Политика - Butterboard

**Версия:** 1.2
**Дата последнего обновления:** 2023-10-27
**Автор:** Елена Петрова, Директор по Развитию Продукта, [elena.petrova@butterboard.online]

### Введение

Butterboard стремится предоставлять нашим клиентам и сотрудникам наилучший опыт онбординга и адаптации. Релизная политика определяет стандарты и процессы, которые мы используем для выпуска новых функций, обновлений и исправлений в платформу. Она гарантирует, что все изменения внедряются последовательно, эффективно и с минимальным воздействием на наших пользователей. Эта политика предназначена для обеспечения согласованности, качества и безопасности нашей платформы, а также для поддержания доверия и удовлетворенности наших клиентов.  Внедрение этой политики является ключевым элементом нашей культуры разработки и поддерживает соответствие принципам DevOps и Agile.

Эта политика распространяется на все команды, участвующие в разработке, тестировании, развертывании и поддержке Butterboard, включая Product Management, Engineering, QA, UX/UI, и Customer Success.

### Процедуры Релиза

Процесс релиза в Butterboard состоит из нескольких четко определенных этапов, которые гарантируют, что каждая новая функция или исправление проходит тщательное тестирование и контроль перед тем, как быть выпущенным для пользователей.

**1. Инициация Релиза (Product Management):**

* **Идея/Запрос на функцию:** Все новые функции или изменения в платформе начинаются с идеи, представленной сотрудником, клиентом или командой Customer Success.
* **Оценка и Приоритезация:** Product Manager (PM) – [Сергей Сидоров, sergey.sidorov@butterboard.online] – оценивает идею на основе ее потенциального воздействия на бизнес, соответствия стратегии продукта и технических возможностей. Идеи ранжируются по приоритету с использованием системы RICE (Reach, Impact, Confidence, Effort).
* **Создание User Story:** После одобрения идеи, PM создает User Story, описывающую функциональность с точки зрения пользователя. Формат User Story должен быть: "Как [тип пользователя], я хочу [цель], чтобы [польза]".
* **Техническая оценка:**  PM вносит запрос в Engineering Manager – [Анна Козлова, anna.kozlova@butterboard.online] – для оценки технической осуществимости и оценки времени разработки.

**2. Разработка и Тестирование (Engineering):**

* **Разработка:** Команды Engineering (в основном, Team A - [Игорь Васильев, igor.vasiliev@butterboard.online] и Team B - [Антон Эйчаров, anton.hroff@butterboard.online]) разрабатывают функциональность, следуя стандартам кодирования Butterboard и используя Agile методологию.
* **Unit Tests:** Каждое изменение кода должно сопровождаться Unit Tests, обеспечивающими корректность отдельных компонентов.
* **Code Review:** Все изменения кода проходят Code Review с участием как минимум двух разработчиков.
* **QA Testing:**  Команда QA – [Дмитрий Петров, dmitry.petrov@butterboard.online] – выполняет функциональное тестирование, регрессионное тестирование и тестирование производительности.  На уровне QA используется Jira для отслеживания багов и задач.
* **Интеграционное тестирование:**  После успешного прохождения Unit Tests и Code Review, производится интеграционное тестирование для проверки взаимодействия между различными компонентами системы.

**3. Подготовка к Релизу (DevOps):**

* **Создание Release Note:** PM совместно с DevOps – [Алексей Смирнов, alexey.smirnov@butterboard.online] – создает Release Note, описывающий изменения, включенные в релиз.  Release Note публикуется в внутренней вики (ссылка: [Внутренняя Вики](https://butterboard-wiki.internal/release-notes)).
* **Подготовка к Развертыванию:** DevOps готовит окружение для развертывания, включая конфигурацию серверов, баз данных и других зависимостей.
* **Разработка Deployment Script:**  DevOps разрабатывает автоматизированный скрипт развертывания (используется Ansible) для обеспечения воспроизводимости и скорости развертывания.

**4. Релиз и Мониторинг (Cross-Functional Team):**

* **Green Light:**  После утверждения QA и DevOps, PM дает "Green Light" для релиза.
* **Развертывание:** DevOps развертывает изменения в production environment, используя подготовленный Deployment Script.
* **Мониторинг:**  После развертывания, команда мониторинга – [Ольга Морозова, olga.morozova@butterboard.online] –  отслеживает производительность системы, ошибки и другие метрики.  Используется Prometheus и Grafana для визуализации данных.
* **Rollback Plan:**  Разработан план отката (Rollback Plan) на случай возникновения серьезных проблем после релиза.  Этот план должен быть доступен всем членам команды.

### Контекст: Релизная Политика

**Типы Релизов:**

* **Feature Release:**  Внедрение новой функции или значительного улучшения существующей.
* **Bug Fix Release:**  Исправление ошибок и уязвимостей.
* **Maintenance Release:**  Внедрение обновлений безопасности, исправление незначительных ошибок и оптимизация производительности.
* **Dark Release:**  Релиз для небольшой группы пользователей (например, бета-тестеров) для сбора обратной связи.

**Уровни Релизов:**

* **Staging:**  Окружение для тестирования перед релизом в Production.
* **Production:**  Основное окружение, доступное для всех пользователей.

### Контакты

* **Product Manager (Оценка и Приоритезация):** Сергей Сидоров – [sergey.sidorov@butterboard.online]
* **Engineering Manager (Техническая Оценка):** Анна Козлова – [anna.kozlova@butterboard.online]
* **Разработчики (Team A):** Игорь Васильев – [igor.vasiliev@butterboard.online]
* **Разработчики (Team B):** Мария Иванова – [maria.ivanova@butterboard.online]
* **QA Engineer (Тестирование):** Дмитрий Петров – [dmitry.petrov@butterboard.online]
* **DevOps Engineer (Развертывание):** Алексей Смирнов – [alexey.smirnov@butterboard.online]
* **Мониторинг:** Ольга Морозова – [olga.morozova@butterboard.online]

### FAQ

**Q: Что такое "Green Light"?**
**A:** "Green Light" – это утверждение Product Manager о том, что функциональность готова к релизу после успешного прохождения тестирования и утверждения DevOps.

**Q: Как сообщать об ошибках?**
**A:** Все ошибки должны быть сообщены в Jira: [Ссылка на Jira](https://jira.butterboard.online).  При создании тикета необходимо указать шаги для воспроизведения ошибки, версию платформы и описание обнаруженного бага.

**Q: Как происходит обратная связь с пользователями после релиза?**
**A:** Обратная связь собирается через различные каналы, включая User Feedback (внутри платформы), email-поддержку, социальные сети и внутренние опросы.  Эта информация используется для улучшения платформы и выявления будущих потребностей пользователей.

**Q: Какие метрики используются для оценки успеха релиза?**
**A:**  Основные метрики включают: количество пользователей, использующих новую функцию, уровень удовлетворенности пользователей, количество ошибок, количество запросов в службу поддержки.

**Q: Что делать, если возникла проблема после релиза?**
**A:**  Немедленно сообщите об инциденте команде мониторинга и DevOps.  Следуйте плану отката, если это необходимо.

**Q: Как обновляется эта политика?**
**A:**  Эта политика будет обновляться по мере необходимости.  Обновления будут анонсироваться через внутреннюю вики и email-рассылку.

**Q:  Пример кода для автоматизированного развертывания (Ansible):**

```yaml
---
- hosts: webservers
  become: true
  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes

    - name: Install required packages
      apt:
        name:
          - apache2
          - php
          - mysql-server
        state: present

    - name: Copy configuration files
      copy:
        src: ./config/
        dest: /var/www/butterboard/config/

    - name: Restart Apache
      service:
        name: apache2
        state: restarted
```

Эта политика является динамичным документом и будет регулярно пересматриваться и обновляться для соответствия потребностям Butterboard.  Пожалуйста, обращайтесь к соответствующим контактам, если у вас есть вопросы или предложения.
```yaml
- php
  - mysql-server
state: present

- name: Copy configuration files
  copy:
    src: ./config/
    dest: /var/www/butterboard/config/

- name: Restart Apache
  service:
    name: apache2
    state: restarted

- name: Ensure MySQL is running
  service:
    name: mysql
    state: started
    enabled: yes

- name: Create database
  mysql_db:
    name: butterboard_db
    state: present
    login_user: root
    login_password: "" # Замените на реальный пароль!

- name: Create database user
  mysql_user:
    name: butterboard_user
    password: "secure_password" # Замените на реальный пароль!
    priv: "ALL PRIVILEGES"
    host: "%" # Разрешить доступ с любого хоста (для разработки, не рекомендуется для production)
    state: present

- name: Grant privileges to database user
  mysql_grant_privilege:
    host: "%"
    user: butterboard_user
    db: butterboard_db
    priv: ALL PRIVILEGES

- name: Update application configuration
  template:
    src: templates/butterboard.conf.j2
    dest: /var/www/butterboard/config/butterboard.conf
    owner: www-data
    group: www-data
    mode: 0644

- name: Ensure application directory exists
  file:
    path: /var/www/butterboard
    state: directory
    mode: 0755
    owner: www-data
    group: www-data

- name: Set correct ownership and permissions on application files
  file:
    path: /var/www/butterboard/*
    owner: www-data
    group: www-data
    mode: 0755

- name: Enable logging
  file:
    path: /var/log/butterboard/error.log
    state: touch
    owner: root
    group: root
    mode: 0644

- name: Enable logging
  file:
    path: /var/log/butterboard/access.log
    state: touch
    owner: root
    group: root
    mode: 0644

- name: Restart Apache again (to apply changes)
  service:
    name: apache2
    state: restarted

- name:  Informational message
  debug:
    msg: "Butterboard deployment complete.  Verify database connection and application configuration."

Эта политика является динамичным документом и будет регулярно пересматриваться и обновляться для соответствия потребностям Butterboard.  Пожалуйста, обращайтесь к соответствующим контактам, если у вас есть вопросы или предложения.  **Важно:**  Замените заполнители паролей ("secure_password") на надежные и уникальные пароли.  Также, для production-окружений, рекомендуется ограничить доступ к базе данных и приложению, используя конкретные IP-адреса или домены.  Рекомендуется использовать переменные окружения для хранения конфиденциальной информации.
```

**Изменения и расширения:**

*   **Добавлено обеспечение работы MySQL:**  Добавлен блок, который гарантирует, что служба MySQL запущена и включена для автоматического запуска при загрузке сервера.
*   **Создание базы данных и пользователя:**  Создается база данных `butterboard_db` и пользователь `butterboard_user` с правами доступа к ней.  **Важно:**  Обязательно замените заполнители паролей на надежные.
*   **Предоставление прав доступа:**  Предоставляются права доступа к базе данных пользователю `butterboard_user`.
*   **Обновление конфигурации приложения:**  Используется шаблон (template) для копирования конфигурационного файла приложения (`butterboard.conf`) из шаблонов.  Установлен правильный владелец и права доступа к файлу.
*   **Создание директории приложения:**  Создается директория `/var/www/butterboard`, если она еще не существует.
*   **Настройка прав доступа к файлам:**  Устанавливаются правильные права доступа к файлам в директории приложения.
*   **Настройка логирования:**  Создаются файлы логов (`error.log` и `access.log`) для отслеживания работы приложения.
*   **Повторный перезапуск Apache:**  Apache перезапускается еще раз, чтобы применить изменения в конфигурации.
*   **Информационное сообщение:**  Отправляется сообщение, информирующее о завершении развертывания и необходимости проверки конфигурации.
*   **Важные замечания:** Добавлены комментарии с важными советами по безопасности и конфигурации, включая использование переменных окружения и ограничение доступа.

**Рекомендации:**

*   **Безопасность:**  Не используйте заполнители паролей в production-окружении.  Используйте переменные окружения или другие безопасные методы хранения конфиденциальной информации.
*   **Ограничение доступа:**  Для production-окружений ограничьте доступ к базе данных и приложению, используя конкретные IP-адреса или домены.
*   **Тестирование:**  После развертывания обязательно протестируйте работу приложения, чтобы убедиться, что все работает правильно.
*   **Версионирование:**  Храните этот файл (политику Ansible) в системе контроля версий (например, Git).
*   **Шаблоны:**  Используйте шаблоны (templates) для динамической генерации конфигурационных файлов.  Это позволит вам легко адаптировать конфигурацию к различным средам.
*   **Модульность:**  Разбейте политику на более мелкие модули для лучшей читаемости и удобства обслуживания.

Этот расширенный код предоставляет более полную и безопасную конфигурацию для развертывания приложения Butterboard.  Помните о важности безопасности и тестирования!