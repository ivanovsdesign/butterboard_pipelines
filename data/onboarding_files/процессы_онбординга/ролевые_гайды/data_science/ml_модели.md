# ML_модели

## ML_модели: Архитектура и Управление

**Дата создания:** 26 октября 2023 г.
**Автор:** Елена Петрова, Специалист по Data Science, Butterboard
**Версия:** 1.0
**Статус:** Активно

**1. Введение**

Этот документ описывает архитектуру и процессы управления машинным обучением (ML) в рамках платформы Butterboard, особенно в контексте нашего ИИ-ассистента онбординга.  Мы используем RAG (Retrieval-Augmented Generation) подход для обеспечения доступа к корпоративной базе знаний, что критически важно для предоставления сотрудникам точной и релевантной информации в процессе адаптации.  Наша стратегия фокусируется на постоянном улучшении модели, мониторинге ее производительности и обеспечении соответствия требованиям безопасности и конфиденциальности.  В данном разделе мы рассмотрим используемые модели, методы обучения, процессы оценки и стратегии обновления.

**2. Используемые Модели**

В настоящее время мы используем следующие модели:

* **Базовая модель:**  Мы используем OpenAI GPT-3.5-turbo в качестве базовой модели для генерации ответов.  Выбор GPT-3.5-turbo обусловлен балансом между стоимостью, скоростью и качеством генерации текста.
* **Модель для RAG:**  Для RAG мы используем векторную базу данных ChromaDB, в которой хранятся эмбеддинги (векторные представления) фрагментов нашей корпоративной базы знаний.  Эмбеддинги создаются с помощью модели OpenAI embeddings-ada-002.  Это позволяет нам быстро находить наиболее релевантные фрагменты знаний для ответа на вопрос пользователя.
* **Модель для классификации обратной связи:**  Мы используем модель Hugging Face Transformers (на основе BERT) для классификации обратной связи, полученной от сотрудников.  Эта модель помогает нам автоматически определять, является ли отзыв позитивным, негативным или нейтральным, а также тему, к которой он относится (например, "непонятная инструкция", "недостаточно информации о продукте").

**3. Архитектура RAG**

Наша архитектура RAG выглядит следующим образом:

1.  **Пользовательский запрос:** Сотрудник задает вопрос через чат-бота Butterboard.
2.  **Embedding:** Запрос преобразуется в векторное представление с помощью модели OpenAI embeddings-ada-002.
3.  **Поиск по ChromaDB:**  Вектор запроса сравнивается с векторами фрагментов знаний в ChromaDB для поиска наиболее релевантных документов.
4.  **Генерация ответа:**  GPT-3.5-turbo использует найденные документы знаний и исходный запрос для генерации ответа.
5.  **Обратная связь:** Сотрудник оценивает качество ответа.  Результат оценки отправляется в модель классификации обратной связи для автоматической обработки.

**Пример кода (Python - упрощенный):**

```python
import chromadb
import openai

# Инициализация ChromaDB
client = chromadb.Client()
collection = client.create_collection("butterboard_knowledge")

# Инициализация OpenAI
openai.api_key = "YOUR_OPENAI_API_KEY"

def get_answer_from_knowledge(query):
    """
    Получает ответ на вопрос, используя RAG.
    """
    # 1. Создание эмбеддинга запроса
    response = openai.Embedding.create(
        input=[query],
        model="text-embedding-ada-002"
    )
    query_embedding = response['data'][0]['embedding']

    # 2. Поиск релевантных документов в ChromaDB
    results = collection.query(
        query_embeddings=[query_embedding],
        n_results=3
    )

    # 3. Генерация ответа с использованием GPT-3.5-turbo
    context = "\n".join(results['documents'][0])
    prompt = f"Используя следующую информацию, ответь на вопрос: {query}\n\nИнформация: {context}"
    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[
            {"role": "user", "content": prompt}
        ]
    )
    return response['choices'][0]['message']['content']

# Пример использования
query = "Как создать новый отчет в Butterboard?"
answer = get_answer_from_knowledge(query)
print(answer)
```

**4. Обучение и Оценка Моделей**

* **Обучение:** Базовая модель GPT-3.5-turbo не требует дополнительного обучения.  Модель классификации обратной связи обучается на размеченном датасете, созданном на основе отзывов сотрудников.  Мы используем метод активного обучения для выбора наиболее информативных отзывов для ручной разметки.
* **Оценка:**  Мы используем следующие метрики для оценки производительности модели:
    * **Точность (Accuracy):**  Процент правильно классифицированных отзывов.
    * **F1-score:**  Среднее гармоническое между точностью и полнотой.
    * **BLEU score:**  Используется для оценки качества сгенерированных ответов.
    * **Оценка человеком:**  Регулярно проводится оценка качества ответов людьми-экспертами.

**5. Управление Моделями и Обновления**

* **Версионирование:**  Мы используем систему версионирования для всех моделей и настроек.  Это позволяет нам легко откатывать к предыдущим версиям в случае возникновения проблем.
* **Мониторинг:**  Мы постоянно отслеживаем производительность моделей с помощью метрик, описанных выше.  Также мы мониторим отклонения в ответах модели, чтобы выявлять потенциальные проблемы (например, “галлюцинации”).
* **Обновления:**  Мы регулярно обновляем базовую модель GPT-3.5-turbo и модель классификации обратной связи.  Обновления проводятся каждые 2-4 недели.
* **Контактное лицо:**  Антон Эйчаров (hr@butterboard.online)  - отвечает за управление обновлением и мониторингом моделей, а также за сбор обратной связи от сотрудников.

**6. Внутренние ссылки**

* [Руководство по использованию RAG](https://butterboard.online/docs/rag-implementation)
* [Документация по ChromaDB](https://chromadb.com/)
* [Обучение модели классификации обратной связи](https://butterboard.online/docs/ml-training-feedback-classification)

**7.  Примеры использования в сценариях онбординга**

* **"Как подключиться к Slack?"**:  Модель использует релевантные фрагменты из базы знаний, описывающие процесс подключения.
* **"Какие инструменты доступны для разработки?"**: Модель предоставляет список доступных инструментов и ссылки на соответствующие ресурсы.
* **"Как подать заявку на оплату?"**: Модель предоставляет пошаговую инструкцию с ссылками на необходимые документы.

Этот документ будет регулярно обновляться по мере развития проекта и появления новых моделей и технологий.  Любые вопросы или предложения по улучшению модели вы можете отправлять на адрес: data-science@butterboard.online.
Продолжим и расширим текст:

**Процесс подключения.**

* **"Какие инструменты доступны для разработки?"**: Модель предоставляет список доступных инструментов для разработки, сгруппированных по категориям:
    * **Языки программирования:** Python (с библиотеками TensorFlow, PyTorch, scikit-learn), R, Julia.  Подробные ссылки на документацию и учебные материалы: [https://python.org/downloads/, https://pytorch.org/, https://scikit-learn.org/stable/, https://www.r-project.org/].
    * **Интегрированные среды разработки (IDE):**  Visual Studio Code (с расширениями для Python и R), PyCharm, Jupyter Notebooks, RStudio.  Ссылки на загрузку и установку: [https://code.visualstudio.com/, https://www.jetbrains.com/pycharm/, https://jupyter.org/, https://www.rstudio.com/].
    * **Облачные платформы:** Google Colab, Amazon SageMaker, Microsoft Azure Machine Learning.  Информация о бесплатных уровнях и ценах: [https://colab.research.google.com/, https://aws.amazon.com/sagemaker/, https://azure.microsoft.com/en-us/services/machine-learning/].
    * **Библиотеки для работы с данными:** Pandas, NumPy, Matplotlib, Seaborn.  Документация и примеры использования: [https://pandas.pydata.org/, https://numpy.org/, https://matplotlib.org/, https://seaborn.pydata.org/].
    * **Инструменты визуализации:** Tableau, Power BI, Plotly.  Демонстрации и руководства: [https://tableau.com/, https://powerbi.microsoft.com/, https://plotly.com/].

* **"Как подать заявку на оплату?"**: Модель предоставляет пошаговую инструкцию с ссылками на необходимые документы.
    1. **Зайдите на страницу оплаты:** [https://www.butterboard.online/payment].
    2. **Заполните форму заявки:** Укажите ваши контактные данные, информацию о проекте и ожидаемую стоимость.  Необходимо предоставить:
        * Название проекта
        * Краткое описание проекта (не более 200 слов)
        * Ожидаемый объем работы (в часах или этапах)
        * Технологии, которые вы планируете использовать
        * Примеры работ (портфолио, ссылки на репозитории)
        * Ваши контактные данные (email и телефон)
    3. **Приложите необходимые документы:**  Обязательно приложите коммерческое предложение, смету и лицензионные соглашения (если применимо).  Форматы файлов: PDF, DOCX.
    4. **Отправьте заявку:** Нажмите кнопку "Отправить заявку".
    5. **Ожидайте рассмотрения:**  Наша команда изучит вашу заявку в течение 3-5 рабочих дней.  Мы свяжемся с вами для уточнения деталей и согласования условий сотрудничества.

* **Дополнительная информация:**
    * **Уровень доступа:**  После одобрения заявки вам будет предоставлен уровень доступа к проекту.
    * **Коммуникация:**  Основным каналом коммуникации является Slack: [https://your-slack-channel-link].
    * **Техническая поддержка:**  Для решения технических вопросов обращайтесь к техническому специалисту: [https://your-technical-support-link].
    * **Политика конфиденциальности:**  Подробную информацию о политике конфиденциальности вы можете найти здесь: [https://www.butterboard.online/privacy].

Этот документ будет регулярно обновляться по мере развития проекта и появления новых моделей и технологий.  Любые вопросы или предложения по улучшению модели вы можете отправлять на адрес: data-science@butterboard.online.  Мы ценим ваше мнение и стремимся предоставить вам наилучший опыт работы!