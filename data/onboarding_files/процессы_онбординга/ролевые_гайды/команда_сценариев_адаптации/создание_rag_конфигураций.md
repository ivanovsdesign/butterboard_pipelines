# Создание_RAG_конфигураций

## Создание RAG конфигураций для Butterboard

**Версия:** 1.0
**Дата:** 26 октября 2023 г.
**Автор:** Екатерина Петрова, Специалист по RAG & Инженерия знаний
**Владелец:** Антон Эйчаров, Head of HR

### Введение

Этот документ описывает процесс создания и настройки RAG (Retrieval-Augmented Generation) конфигураций в Butterboard. RAG является ключевой технологией, обеспечивающей, что наш ИИ-ассистент, "Бутерброд" (Butter), обладает доступом к актуальной и релевантной информации из нашей корпоративной базы знаний, а не просто полагается на общие знания, полученные во время обучения.  Правильно настроенные RAG конфигурации обеспечивают точные, контекстуальные и полезные ответы сотрудникам, что является основой эффективного онбординга и адаптации.

В данном документе мы рассмотрим:

*   Основные компоненты RAG конфигурации.
*   Процесс создания новой конфигурации.
*   Оптимизацию и мониторинг производительности RAG.
*   Рекомендации по выбору и настройке различных моделей языковых моделей (LLM).

### Основные компоненты RAG конфигурации

RAG конфигурация Butterboard состоит из следующих ключевых элементов:

1.  **Источник данных (Knowledge Base):**  Это база знаний, из которой будет извлекаться информация. В нашем случае, это централизованная система документов, статей, инструкций и других ресурсов, доступных сотрудникам Butterboard.
2.  **Индекс (Vector Store):**  Индекс – это структура данных, которая позволяет быстро находить релевантные фрагменты информации из Knowledge Base на основе семантического сходства. В Butterboard мы используем Pinecone в качестве векторного хранилища.
3.  **Модель извлечения (Retrieval Model):**  Эта модель отвечает за поиск наиболее релевантных фрагментов информации в индексе на основе запроса пользователя.  Мы используем OpenAI Embeddings для создания векторов, представляющих документы.
4.  **Модель генерации (Generation Model):**  Эта модель отвечает за генерацию ответа на основе запроса пользователя и извлеченных фрагментов информации.  В настоящее время мы используем GPT-3.5-turbo для генерации ответов.
5.  **Сценарий (Scenario):** Определяет последовательность шагов и действий, которые ИИ-ассистент должен выполнить во время онбординга сотрудника.  Сценарии связываются с определенной ролью и настраивают контекст для RAG.

### Процесс создания RAG конфигурации

1.  **Определение Роли и Сценария:**  Первый шаг – определение роли, для которой создается конфигурация.  Роли в Butterboard определяются на основе специализации сотрудника (например, "Разработчик Frontend", "Менеджер по продажам", "HR-специалист").  Для каждой роли разрабатывается соответствующий сценарий.  Сценарий состоит из этапов, каждый из которых содержит конкретные инструкции для ИИ-ассистента, ссылки на документы и запросы к базе знаний.
    *   **Пример сценария (Разработчик Frontend):**
        *   **Этап 1: Знакомство с проектами:**  "Покажи список текущих проектов, над которыми работает сотрудник."  (Ссылка: [Внутренняя документация по проектам](https://intranet.butterboard.online/projects))
        *   **Этап 2: Настройка окружения:**  "Как настроить локальную среду разработки для проекта X?" (Ссылка: [Руководство по настройке окружения](https://intranet.butterboard.online/environment-setup/project-x))
        *   **Этап 3:  Обзор архитектуры:** "Опиши архитектуру приложения X." (Ссылка: [Диаграмма архитектуры приложения X](https://intranet.butterboard.online/architecture/project-x))
2.  **Подготовка Knowledge Base:**  Необходимо собрать все документы, статьи и инструкции, относящиеся к выбранной роли и сценарию.  Эти документы должны быть структурированы и оптимизированы для поиска.  Рекомендуется использовать Markdown файлы с четкими заголовками и подзаголовками.
3.  **Создание Векторного Индекса:**  Используя Python и библиотеку OpenAI, создается векторный индекс на основе документов Knowledge Base.  Каждый документ разбивается на небольшие фрагменты (chunks), и для каждого фрагмента генерируется векторное представление (embedding).  Эти векторы сохраняются в Pinecone.
    *   **Пример кода (Python):**
        ```python
        import openai
        import pinecone
        import os

        openai.api_key = os.environ.get("OPENAI_API_KEY")
        pinecone.init(api_key=os.environ.get("PINECONE_API_KEY"), environment=os.environ.get("PINECONE_ENVIRONMENT"))

        def create_index(index_name, dimension):
            if index_name not in pinecone.list_indexes():
                pinecone.create_index(index_name, dimension=dimension)
            return pinecone.Index(index_name)
        ```
4.  **Настройка Retrieval Model:**  Настраивается модель извлечения, чтобы она могла эффективно находить релевантные фрагменты информации в индексе.  В нашей конфигурации мы используем OpenAI Embeddings.
5.  **Настройка Generation Model:**  Настраивается модель генерации, чтобы она могла генерировать точные и полезные ответы.  Мы используем GPT-3.5-turbo.
6.  **Интеграция с Butter:**  RAG конфигурация интегрируется с интерфейсом Butter.  Когда сотрудник задает вопрос, система сначала ищет релевантную информацию в индексе, а затем использует модель генерации для формирования ответа.

### Оптимизация и Мониторинг

*   **Оценка ответов:**  Необходимо регулярно оценивать качество ответов, генерируемых Butter.  Сотрудники могут оценивать ответы по шкале от 1 до 5.  Эти оценки используются для обучения и улучшения модели генерации.  Обратная связь от сотрудников (например, через чат-бот) также важна.
*   **Анализ запросов:**  Анализ запросов сотрудников помогает выявить области, в которых RAG конфигурация работает недостаточно хорошо.  Это может указывать на необходимость добавления новых документов в Knowledge Base или улучшения модели извлечения.
*   **Мониторинг производительности:**  Необходимо отслеживать время ответа, точность ответов и другие метрики производительности RAG конфигурации.  Это позволяет выявлять узкие места и оптимизировать систему.  Для мониторинга используется панель мониторинга, разработанная командой DevOps.

### Контакты

*   **Олег Иванов (CEO, CTO, Head of Vibe Coding Department):** o.ivanov@butterboard.online
*   **Антон Титоренко (CEO, CMO, Head of JSON Parsing Department):** a.titorenko@butterboard.online
*   **Антон Эйчаров (Head of HR):** hr@butterboard.online
*   **Команда RAG:**  rag-team@butterboard.online (Внутренняя ссылка: [Внутренняя страница команды RAG](https://intranet.butterboard.online/rag-team))

### FAQ

*   **Вопрос:**  Как часто нужно обновлять Knowledge Base?
    **Ответ:**  Необходимо регулярно обновлять Knowledge Base, чтобы она содержала актуальную информацию.  Рекомендуется проводить обновления не реже одного раза в месяц.
*   **Вопрос:**  Какие модели языковых моделей (LLM) вы планируете использовать в будущем?
    **Ответ:**  Мы постоянно исследуем новые модели языковых моделей и планируем перейти на более мощные и эффективные модели по мере их появления.
*   **Вопрос:**  Как можно подать заявку на создание новой RAG конфигурации?
    **Ответ:**  Заявки на создание новых RAG конфигураций принимаются у Антона Эйчарова (hr@butterboard.online).  Необходимо предоставить описание роли, сценария и необходимых документов.
Вот продолжение и расширение текста, учитывающее контекст и логику предыдущих ответов, а также добавляющее больше деталей и возможных направлений:

**Вопрос:** Какие модели языковых моделей (LLM) вы планируете использовать в будущем?
    **Ответ:** Мы постоянно исследуем новые модели языковых моделей и планируем перейти на более мощные и эффективные модели по мере их появления. В настоящее время мы активно тестируем и оцениваем возможности моделей от OpenAI (например, GPT-4 и GPT-4o), Google (Gemini), Anthropic (Claude) и Meta (Llama 2).  Особое внимание уделяется моделям, демонстрирующим улучшенную способность к рассуждению, пониманию контекста и генерации более креативных и точных ответов.  Мы также изучаем возможности fine-tuning этих моделей на наших собственных данных, чтобы адаптировать их к специфическим требованиям Butterboard и повысить релевантность ответов для наших пользователей.  В будущем мы планируем экспериментировать с моделями с открытым исходным кодом, чтобы обеспечить большую прозрачность и гибкость.  Ключевыми критериями для выбора будущих моделей будут не только размер и вычислительная мощность, но и стоимость, доступность API, лицензионные ограничения и, что немаловажно, соответствие принципам безопасности и этики.

*   **Вопрос:** Как можно подать заявку на создание новой RAG конфигурации?
    **Ответ:** Заявки на создание новых RAG конфигураций принимаются у Антона Эйчарова (hr@butterboard.online). Необходимо предоставить описание роли, сценария и необходимых документов.  В заявке также важно указать:
        *   **Цель RAG конфигурации:**  Какую конкретную задачу она должна решать? (Например, ответы на вопросы о продуктах, генерация описаний товаров, создание маркетинговых текстов).
        *   **Определение роли:**  Для какой роли или группы пользователей предназначена эта конфигурация? (Например, клиентская поддержка, отдел продаж, маркетинг).
        *   **Сценарий использования:**  Приведите конкретные примеры того, как пользователи будут взаимодействовать с конфигурацией.  Опишите типичные вопросы или запросы.
        *   **Необходимые документы:**  Перечислите все документы, которые необходимо использовать для ответов (например, FAQ, руководства пользователя, спецификации продуктов, статьи в блоге).  Укажите формат документов (текст, PDF, HTML и т.д.).
        *   **Ожидаемый формат ответа:**  Как должны быть представлены ответы? (Например, краткий ответ, подробное объяснение, список, таблица).
        *   **Ключевые показатели эффективности (KPI):**  Какие метрики будут использоваться для оценки успеха конфигурации? (Например, точность ответов, скорость ответа, удовлетворенность пользователей).
        Мы также будем рады получить обратную связь о существующих конфигурациях, чтобы постоянно улучшать качество нашей системы.  После рассмотрения заявки, Антон свяжется с вами для обсуждения деталей и дальнейших шагов.

*   **Вопрос:**  Какие типы данных вы будете использовать для обучения и улучшения ваших LLM?
    **Ответ:**  Мы планируем использовать широкий спектр данных для обучения и улучшения наших LLM.  Это включает в себя:
        *   **Наши собственные данные:**  Все взаимодействия пользователей с платформой Butterboard, включая запросы, ответы, оценки и отзывы.
        *   **Общедоступные данные:**  Большие языковые корпуса, такие как Common Crawl, Wikipedia и книги.
        *   **Специализированные данные:**  Данные, относящиеся к нашей нише (например, данные о продуктах, маркетинговые материалы, техническая документация).
        *   **Синтетические данные:**  Данные, сгенерированные искусственно для обучения конкретным задачам или сценариям.
        *   **Данные, предоставленные пользователями:**  Мы будем поощрять пользователей делиться своим опытом и знаниями, чтобы улучшить качество ответов.  Мы также планируем разработать механизмы для проверки и фильтрации этих данных, чтобы обеспечить их качество и достоверность.  Мы осознаем важность соблюдения конфиденциальности и безопасности данных, поэтому будем использовать строгие меры защиты данных при обработке всех типов информации.

Этот расширенный ответ дает более полную картину планов компании, включая конкретные модели, процесс подачи заявок, типы данных для обучения и акцент на важности качества и безопасности данных.  Он также добавляет больше деталей и практических рекомендаций.