# Код_ревью

## Код_ревью: Процедура и рекомендации

**Дата:** 26 октября 2023
**Автор:** Елена Петрова, Lead Engineer, Butterboard
**Версия:** 1.0

**Введение**

Этот документ описывает процедуру и рекомендации по Code Review (ревью кода) внутри Butterboard.  Код-ревью – критически важный элемент нашей культуры разработки, направленный на улучшение качества кода, выявление ошибок на ранних этапах, распространение знаний внутри команды и обеспечение соответствия кода стандартам Butterboard.  Мы используем Code Review как возможность для обучения и обмена опытом между разработчиками.  В контексте интеграции Butterboard, это также ключевой элемент демонстрации надежности и качества нашей платформы для потенциальных клиентов.

**Цель Code Review**

*   **Качество кода:**  Выявление и исправление ошибок, уязвимостей, логических ошибок и проблем с производительностью.
*   **Соблюдение стандартов:**  Убедиться, что код соответствует внутренним стандартам кодирования Butterboard (описаны в [Руководство по стилю кодирования](https://butterboard.online/style-guide)).
*   **Знания и опыт:**  Передача знаний между разработчиками, особенно между новичками и опытными сотрудниками.
*   **Совместная ответственность:**  Распределение ответственности за качество кода между всеми членами команды.
*   **Демонстрация продукта:**  В контексте демонстраций для клиентов, Code Review служит примером нашего процесса разработки и внимания к деталям.

**Процедура Code Review**

1.  **Запуск Pull Request (PR):** Разработчик, завершивший работу над фичей или исправлением ошибки, создает Pull Request в системе контроля версий (Git).
2.  **Автоматизированный Check:** Перед началом ручного ревью,  автоматизированные инструменты (например, linters и статические анализаторы) проверяют код на соответствие стандартам и выявляют потенциальные проблемы.  Для этого используется GitHub Actions, интегрированный в наш репозиторий.  Пример конфигурации GitHub Actions: [Ссылка на конфигурацию GitHub Actions](https://github.com/butterboard/butterboard-project/actions/workflows/ci.yml).
3.  **Приоритезация PR:**  Антон Титоренко (CMO, Head of JSON Parsing Department)  и Олег Иванов (CEO, CTO, Head of Vibe Coding Department)  регулярно просматривают список открытых PR, чтобы обеспечить приоритет для наиболее важных задач.
4.  **Назначение Reviewers:**  Разработчик, создавший PR, назначает одного или нескольких reviewers.  Рекомендации по назначению reviewers:
    *   **Специализация:**  Reviewer должен обладать опытом в области, к которой относится код.
    *   **Знание контекста:**  Reviewer должен понимать цель фичи или исправления.
    *   **Размер PR:**  Для небольших PR (до 200 строк) достаточно одного reviewera. Для больших PR рекомендуется назначить двух или более reviewers.
5.  **Процесс Review:**  Reviewer внимательно изучает код, обращая внимание на:
    *   **Логика:**  Соответствие логики кода заданным требованиям.
    *   **Читаемость:**  Легкость понимания кода, понятные имена переменных и функций.
    *   **Тестирование:**  Наличие достаточного количества unit-тестов и интеграционных тестов.
    *   **Безопасность:**  Выявление потенциальных уязвимостей.
    *   **Производительность:**  Оптимизация кода для повышения производительности.
6.  **Отзывы и Комментарии:**  Reviewer предоставляет конструктивную критику и предложения по улучшению кода, используя комментарии в PR.  Важно быть вежливым и уважительным, объяснять причины своих замечаний.
7.  **Итерации:**  Разработчик вносит изменения в код на основе отзывов reviewers.  PR обновляется, и процесс review повторяется до тех пор, пока все reviewers не согласятся с изменениями.
8. **Закрытие PR:** После успешного прохождения Code Review PR закрывается.

**Инструменты**

*   **Git:** Система контроля версий.
*   **GitHub:** Платформа для хостинга репозиториев и управления PR.
*   **Slack:**  Используется для обсуждения PR и координации работы.  #code-review канал – основной канал для обсуждения PR.
*   **SonarQube (в будущем):** Планируется внедрение SonarQube для автоматизированного анализа кода на соответствие стандартам качества.

**Пример комментария в PR:**

```
@ivan.petrov (Ivan Petrov)  
Обратите внимание, что использование `forEach` здесь может быть не самым эффективным способом. Рассмотрите возможность использования `map` для более лаконичного и производительного кода.

```

**Рекомендации**

*   **Будьте активны:**  Не ждите, пока кто-то напомнит вам о PR.  Регулярно проверяйте список открытых PR и своевременно выполняйте review.
*   **Будьте конкретны:**  Предоставляйте конкретные и понятные комментарии, указывая на то, что именно нужно исправить или улучшить.
*   **Будьте конструктивны:**  Сосредоточьтесь на улучшении кода, а не на критике разработчика.
*   **Задавайте вопросы:**  Если что-то непонятно, не стесняйтесь задавать вопросы.
*   **Соблюдайте сроки:**  Постарайтесь завершить review в течение 24-48 часов.

**Контакты**

*   **Антон Эйчаров (Head of HR):** hr@butterboard.online –  Для вопросов, касающихся процесса Code Review и соблюдения стандартов компании.
*   **Олег Иванов (CEO, CTO, Head of Vibe Coding Department):** o.ivanov@butterboard.online –  Для вопросов, касающихся стратегии развития Code Review в компании.
*   **Антон Титоренко (CEO, CMO, Head of JSON Parsing Department):** a.titorenko@butterboard.online –  Может помочь с приоритезацией PR и привлечением reviewers.

**Следующие шаги**

*   Внедрение SonarQube для автоматизированного анализа кода.
*   Разработка шаблонов для PR с четкими инструкциями для разработчиков и reviewers.
*   Организация внутренних семинаров и тренингов по Code Review.
**Следующие шаги**

*   Внедрение SonarQube для автоматизированного анализа кода. Это позволит выявлять потенциальные проблемы, такие как дублирование кода, уязвимости безопасности и нарушения стандартов кодирования, на ранних этапах разработки, значительно снижая количество ошибок в будущем. Необходимо определить ключевые правила SonarQube, соответствующие нашим стандартам качества, и настроить интеграцию с CI/CD пайплайном.
*   Разработка шаблонов для PR с четкими инструкциями для разработчиков и reviewers. Шаблоны должны включать обязательные поля, такие как описание изменений, тестовые примеры, ожидаемые результаты, и вопросы, которые reviewers должны задать. Важно, чтобы шаблоны были понятными и простыми в использовании, чтобы Code Review не превращался в трудоемкий процесс.  Также стоит рассмотреть возможность использования масок для автоматического форматирования PR-запросов.
*   Организация внутренних семинаров и тренингов по Code Review.  Семинары должны охватывать как принципы эффективного Code Review, так и специфические аспекты нашей кодовой базы.  Рекомендуется проводить как теоретические занятия, так и практические упражнения с примерами кода.  Можно организовать ролевые игры, чтобы разработчики могли попрактиковаться в роли reviewers и разработчиков.
*   **Назначение "Code Review Champions"**:  Выделить несколько опытных разработчиков, которые будут выступать в роли экспертов по Code Review, помогать новым членам команды и поддерживать стандарты.
*   **Внедрение системы метрик Code Review**:  Отслеживание таких показателей, как время, затрачиваемое на Code Review, количество найденных ошибок, количество отклоненных PR, и удовлетворенность reviewers. Это позволит оценивать эффективность процесса и выявлять области для улучшения.
*   **Регулярные Code Review Retrospectives**:  Проводить короткие встречи после завершения цикла Code Review, чтобы обсудить, что прошло хорошо, что можно улучшить, и какие новые инструменты или процессы стоит попробовать.
*   **Создание базы знаний по Code Review**:  Собрать лучшие практики, примеры кода, шаблоны и ответы на часто задаваемые вопросы в едином месте, чтобы все члены команды могли легко получить доступ к необходимой информации.
*   **Интеграция с системой управления задачами**:  Настроить связь между задачами в системе управления проектами (Jira, Trello и т.д.) и PR, чтобы обеспечить прозрачность и отслеживаемость изменений.
*   **Обучение принципам SOLID и других паттернов проектирования**:  Улучшение качества кода с самого начала, что облегчает процесс Code Review и снижает вероятность возникновения проблем в будущем.

**Приоритеты (в порядке убывания):**

1.  Разработка шаблонов для PR
2.  Внедрение SonarQube
3.  Организация внутренних семинаров и тренингов

Этот расширенный план включает в себя более конкретные шаги и рекомендации, а также предлагает метрики для оценки эффективности внедрения.  Важно помнить, что Code Review - это не просто проверка кода, а важный процесс обучения и обмена знаниями внутри команды.